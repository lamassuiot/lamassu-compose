version: '3'

services:
  base-service:
    environment:
      DEBUG_MODE: ${DEBUG_MODE}
      PORT: 8085
      PROTOCOL: https
      CERT_FILE: /certs/tls.crt
      KEY_FILE: /certs/tls.key
      MUTUAL_TLS_ENABLED: "true"
      MUTUAL_TLS_CLIENT_CA: /certs/internal-ca.crt
      AMQP_SERVER_HOST: rabbitmq
      AMQP_SERVER_PORT: 5671
      AMQP_SERVER_CA_CERT: /certs/internal-ca.crt
      DEPLOYMENT_ENVIRONMENT: ${DEPLOYMENT_ENVIRONMENT}
      JAEGER_EXPORTER_URL: http://jaeger:14268/api/traces
    volumes:
      - ./tls-certificates/upstream/ca.crt:/certs/internal-ca.crt
    restart: on-failure